# <center>Starbot Manual 

### 💕基于```release v1.0.1-alpha```

---

## 目录

### · [基本聊天回复](#基本聊天回复)
### · [色图模块](#色图模块)
### · [回复语料库的编写](#回复语料库的编写)
### · [群管理功能的使用](#群管理功能的使用)
### · [原理解析与基础排错](#原理解析与基础排错)

---

## <center>基本聊天回复

在你配置启用的群内的消息（根据你的配置决定是否需要@机器人），以及任何对机器人的私聊，都会触发这个主要模块。**你需要先建表！请参阅基础使用内最后一节。**

主要讲讲回复检索的逻辑，省略了消息与通知的类型判断，直接从收到消息说起：

<div align="center"><img src="http://175.24.71.180/wp-content/uploads/2021/09/msg_handle.png" width="560px"></div>

从逻辑就可以看出结果，一切回复都是基于数据层——你的语料库的。语料（数据库数据内容）的编写规则，请参阅第三节。

对于jieba默认词库分词不准的问题，请自行改动根目录下```dict.txt```和```tfidf.txt```，不知道如何修改的自己百度。

--- 

## <center>色图模块

这个模块其实才是最重要的主要模块！（bushi）

正如其名，叫机器人发涩图的。很简单，只要你在任何有机器人的群内/私聊发了"setu"四个字母，不能多不能少不能换位置就这四个，它就会返回一条随机涩图。

这些是你需要注意的：

* 首先，它返回的色图是从你设置的**涩图目录随机抽取的**，目录内只有```png/jpeg/jpg```三种后缀的文件会被抽取，请**自己转换格式**。

  其实有考虑过这个很有趣的[大佬的API](https://api.lolicon.app/#/setu)。但是因为图源必须实时从Pixiv拉取，中国大陆内不太友好，我实测反应时间接近两分钟并且随缘超时。
* 第二，它的优先级实际上是最高的。所有的判断语句都在它后面。这意味着叫机器人发涩图，回复一般是最快的。
* 第三，很重要的一点。**所有机器人在的地方，这个模块都生效！** 无论某个群有没有在你的config内，只要机器人在里面，只要没被禁言，都可以触发这个模块！这是我故意为之的，现版本不会修改，未来可能会修改。

---

## <center>回复语料库的编写

**首先请确保你正确创建了数据表！**

### 格式

* 基础格式 
  * 单行文字回复：
  ```这是一条回复！```
  * 多行文字回复：
  ```第一行：涩图！\n第二行：涩图！\n第三行：更多涩图！```
* 高级内容
  * 请自己参阅 **[go-cqhttp帮助文档 - CQ Code](https://docs.go-cqhttp.org/cqcode/)**
  * 这里给出一条闪照图片示例：
  ```[CQ:image,file=https://img.chkaja.com/del.php?DELCODE=KJ3ae7bf327de3d66e,type=flash]```
  * **请注意！你写在数据库内的CQ码内容，不要包含任何空格，例如```[CQ:image, file=...]```，在逗号后的那个空格会导致错误发生！**

### 写入方式

* 方式A：你会数据库操作
  * 自行对数据库进行操作。
* 方式B：使用**所有者账号私聊**自动添加
  * 像这样：<div align="center"><img src="http://175.24.71.180/wp-content/uploads/2021/09/3159852de00059d4.png" width="500px"></div>
    机器人不会进行任何回复，同样的，你可以自己写入CQ码内容，但方括号内不要包含空格。

---

## <center>群管理功能的使用

### 功能列表：

群管理目前提供了以下功能
1. [踢人](#踢人)
2. [单人禁言](#单人禁言)
3. [全员禁言](#全员禁言)
4. [设置管理员](#设置管理员)
5. [修改群名片](#修改群名片)
6. [设置群名](#设置群名)
7. [设置群专属头衔](#专属头衔) *pre*
8. [上传群文件](#上传群文件) *pre*
9. [发送群公告](#发送群公告) *pre*

---

### 使用规则：

按照以下代码示例格式，使用具有机器人管理员权限的账号私聊/群聊机器人（如果私聊，则账户不能是机器人所有者），执行成功后不会有回复提示，执行失败也不会有，指令拼写错误会回复报错。

请确保你发出的指令是以```@$```开头，以```@$```结束。方括号内的是必填参数，圆括号为有默认值的选填参数。**参数不要带着方括号！当然也不是叫你把CQ码的方括号删了！**

发出指令前请确定条件满足了文档内写到的条件，是否成功执行请自行确认。

---

### 踢人

**条件：在群，是管理员或更高。**

```@$踢人@$[群号]@$[用户QQ号]@$```

或

```@$踢人@$[群号]@$[用户QQ号]@$(true/false)@$```此处的true指禁止用户再次加群，此值不填默认为false。

### 单人禁言

**条件：在群，是管理员或更高。**

```@$禁言@$[群号]@$[用户QQ号]@$[持续时间(以秒为单位)]@$```

### 全员禁言

**条件：在群，是管理员或更高。**

```@$全员禁言@$[群号]@$```

或

```@$全员禁言@$[群号]@$(true/false)@$```此处true为开启全员禁言，false为关闭，不填默认为true。

### 设置管理员

**条件：在群，是群主。**

```@设置管理员@$[群号]@$[用户QQ号]@$```

或

```@设置管理员@$[群号]@$[用户QQ号]@$(true/false)@$```此处true为设置管理员，false为取消管理员，不填默认为true。

### 修改群名片

**条件：在群，是管理员或更高。**

```@$设置群名片@$[群号]@$[用户QQ号]@$[名片内容]@$```

### 设置群名

**条件：在群，是管理员或更高。**

```@$设置群名@$[群号]@$[群名]@$```

### 专属头衔

*此功能为 pre版本，设置后不会有群通知，不会自动装备，需要目标自己在手机QQ装备。*

**条件：在群，是群主。**

```@$设置头衔@$[群号]@$[用户QQ号]@$[头衔内容]@$```

### 上传群文件

*此功能为 pre版本，仅支持上传到群文件根目录，文件不能是网络链接，需要是本地链接例如```file:///C:/file.zip```*

**条件：在群，是管理员或更高。** 或 **在群，群设置为允许任何群成员上传文件。**

```@$上传群文件@$[群号]@$[文件地址]@$[上传后的文件名]@$```

### 发送群公告

*此功能为 pre版本，仅支持文字公告，无法附加图片。*

**条件：在群，是管理员或更高。**

```@$发公告@$[群号]@$[公告内容]@$``` **公告内的换行请用\n代替！**

---


